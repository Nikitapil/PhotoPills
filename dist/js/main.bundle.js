(()=>{"use strict";const e=document.querySelector(".readyfilters__items"),t=document.querySelector(".photocomparer"),o=document.querySelector(".photocomparer__separator"),r=document.querySelector(".photomaker__upload-input"),l=document.querySelector(".photomaker__preload"),n=document.querySelector(".photocomparer__origin-photo"),a=document.querySelector(".photocomparer__modified-photo"),i=document.querySelector(".photomaker__canvas"),c=i.getContext("2d"),d=document.querySelectorAll(".photoeditor__userf"),s=document.querySelector(".userfilters__inputs"),u=document.querySelector(".readyfilters__items"),m=document.querySelector(".photomaker__dowload");let h=!1;function _(e){if(h){const r=document.querySelector(".photocomparer__modified-photo");let l=e.pageX-t.getBoundingClientRect().left;console.log(l),l>0&&l<t.offsetWidth&&(r.style.width=l+"px",o.style.left=l+"px")}}document.addEventListener("click",(t=>{let o=t.target;if(o.closest(".readyfilters__navigation-left")&&e.scrollBy(-105,0),o.closest(".readyfilters__navigation-right")&&e.scrollBy(105,0),o.closest(".photomaker__save-btn")){let e=getComputedStyle(l).filter,t=document.querySelector(".photomaker__preload img");t&&(c.filter=e,c.drawImage(t,0,0),m.href=i.toDataURL(),m.classList.remove("disabled-link"))}(o.closest(".header__mobile")||o.closest(".header__nav-link"))&&(document.querySelector(".header__mobile").classList.toggle("active-mobile"),document.querySelector(".header__nav-list").classList.toggle("active-mobile"))})),o.addEventListener("mousedown",(()=>{h=!0})),o.addEventListener("mouseup",(()=>{h=!1})),o.addEventListener("touchstart",(()=>{h=!0})),o.addEventListener("touchend",(()=>{h=!1})),t.addEventListener("mousemove",_),t.addEventListener("touchmove",_),r.addEventListener("change",(function(){if(this.files){let e=this.files[0];if(e.type.match(/image.*/)){l.innerHTML="",n.innerHTML="",a.innerHTML="";let o=new FileReader;o.onload=function(){let e=new Image;e.src=o.result;let r=e.cloneNode(!0),c=e.cloneNode(!0);l.append(e),n.append(r),a.append(c),t.style.minHeight="fit-content",e.onload=function(){i.width=this.naturalWidth,i.height=this.naturalHeight}},o.readAsDataURL(e)}}})),s.addEventListener("input",(e=>{if(e.target.closest(".photoeditor__userf")){let e=Array.from(d).map((e=>"blur"==e.name?`${e.name}(${e.value}px)`:`${e.name}(${e.value}%)`)).join(" ");l.style.filter=e,a.style.filter=e,m.classList.add("disabled-link")}})),u.addEventListener("click",(e=>{let t=e.target;if(t.closest(".readyfilter__btn")){let e=getComputedStyle(t).filter;l.style.filter=e,a.style.filter=e,m.classList.add("disabled-link")}}));const p=document.querySelector(".paint__canvas"),f=p.getContext("2d"),g=document.querySelector(".paint__body"),y=document.querySelector(".paint__download"),v=document.querySelector(".paint__color"),S=document.querySelector(".paint__eraiser");y.href=p.toDataURL();let L=!1;function k(e){L=!0,f.beginPath(),f.moveTo(e.pageX-p.offsetLeft,e.pageY-p.offsetTop)}function q(e){if(1==L){let t=e.pageX-p.offsetLeft,o=e.pageY-p.offsetTop;f.lineTo(t,o),f.stroke()}}function w(){L=!1,y.href=p.toDataURL()}window.onload=function(){p.width=g.offsetWidth},g.addEventListener("click",(e=>{e.target.closest(".paint__clear")&&f.clearRect(0,0,p.width,p.height)})),g.addEventListener("change",(e=>{e.target.closest(".paint__fill")&&(f.fillStyle=e.target.value,f.fillRect(0,0,p.width,p.height)),e.target.closest(".paint__width")&&(f.lineWidth=e.target.value),e.target.closest(".paint__color")&&(S.checked?f.strokeStyle="white":f.strokeStyle=v.value),e.target.closest(".paint__eraiser")&&(e.target.checked?f.strokeStyle="white":f.strokeStyle=v.value)})),p.onmousedown=k,p.onmouseup=w,p.onmouseout=w,p.onmousemove=q,p.touchstart=k,p.touchend=w,p.touchcancel=w,p.touchmove=q;const E=document.querySelectorAll(".multilang"),b=document.querySelector(".header__lang-checkbox");function T(){E.forEach((e=>{b.checked?(e.innerText=e.dataset.eng,localStorage.setItem("photolang","eng")):(e.innerText=e.dataset.ru,localStorage.setItem("photolang","ru"))}))}b.addEventListener("change",T),localStorage.getItem("photolang")&&("eng"===localStorage.getItem("photolang")?b.checked=!0:b.checked=!1,T())})();